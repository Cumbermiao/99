(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["userDetails"],{"05c3":function(t,e,n){"use strict";n("8b2d")},"212e":function(t,e,n){"use strict";n("477d")},"477d":function(t,e,n){},4892:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"details"},[n("div",{staticClass:"details-1"},[n("img",{attrs:{src:t.imgSrc("grxx_user.png"),mode:""}})]),n("div",{staticClass:"details-2"},[n("div",{staticClass:"title"},[t._v("请完善个人信息")]),n("div",{staticClass:"content"},[n("div",{staticClass:"left"},[t._v("昵称")]),n("div",{staticClass:"right"},[n("div",{staticClass:"right-1"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.nickName,expression:"userInfo.nickName"}],attrs:{type:"text"},domProps:{value:t.userInfo.nickName},on:{input:function(e){e.target.composing||t.$set(t.userInfo,"nickName",e.target.value)}}})]),n("img",{attrs:{src:t.imgSrc("jiantou.png"),mode:""}})])]),n("div",{staticClass:"content",on:{click:t.showGender}},[n("div",{staticClass:"left"},[t._v("性别")]),n("div",{staticClass:"right"},[n("div",{staticClass:"right-1"},[t._v(t._s(t.genderName||"请选择"))]),n("img",{attrs:{src:t.imgSrc("jiantou.png"),mode:""}})])]),n("div",{staticClass:"content",on:{click:t.showDate}},[n("div",{staticClass:"left"},[t._v("出生日期")]),n("div",{staticClass:"right"},[n("div",{staticClass:"right-1"},[t._v(t._s(t.userInfo.birthday||"请选择"))]),n("img",{attrs:{src:t.imgSrc("jiantou.png"),mode:""}})])]),n("div",{staticClass:"content",on:{click:t.showAddress}},[n("div",{staticClass:"left"},[t._v("地区"),n("text",{staticStyle:{color:"#FF2342","margin-left":".3125rem"}},[t._v("*")])]),n("div",{staticClass:"right"},[n("div",{staticClass:"right-1"},[t._v(t._s(t.address))]),n("img",{attrs:{src:t.imgSrc("jiantou.png"),mode:""}})])])]),n("div",{staticClass:"details-3",on:{click:t.save}},[t._v("确定")]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.mubuKey,expression:"mubuKey"}],staticClass:"mubu"},[n("div",{staticClass:"picker"},[n("picker",{attrs:{"show-toolbar":"",columns:t.multiArray},on:{change:t.changePicker,confirm:t.confirm,cancel:t.onCancel}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.mubuKey1,expression:"mubuKey1"}],staticClass:"mubu"},[n("div",{staticClass:"picker"},[n("datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.confirmDate,cancel:t.closeDate},model:{value:t.birthday,callback:function(e){t.birthday=e},expression:"birthday"}})],1)]),n("gender-select",{ref:"gender",attrs:{showKey:t.genderKey},on:{change:t.changeSex}})],1)},a=[],r=n("1da1"),s=n("2909"),u=(n("96cf"),n("d3b7"),n("ddb0"),n("d81d"),n("99af"),n("a434"),n("7db0"),n("f253")),o=n("c31d"),c=n("d282"),l=n("68ed"),h=n("482d"),d=n("90c6");function m(t,e){var n=-1,i=Array(t);while(++n<t)i[n]=e(n);return i}function f(t){if(!t)return 0;while(Object(d["a"])(parseInt(t,10))){if(!(t.length>1))return 0;t=t.slice(1)}return parseInt(t,10)}function p(t,e){return 32-new Date(t,e-1,32).getDate()}var g=n("1b10"),v=Object(o["a"])({},g["b"],{value:null,filter:Function,columnsOrder:Array,showToolbar:{type:Boolean,default:!0},formatter:{type:Function,default:function(t,e){return e}}}),y={data:function(){return{innerValue:this.formatValue(this.value)}},computed:{originColumns:function(){var t=this;return this.ranges.map((function(e){var n=e.type,i=e.range,a=m(i[1]-i[0]+1,(function(t){var e=Object(l["b"])(i[0]+t);return e}));return t.filter&&(a=t.filter(n,a)),{type:n,values:a}}))},columns:function(){var t=this;return this.originColumns.map((function(e){return{values:e.values.map((function(n){return t.formatter(e.type,n)}))}}))}},watch:{columns:"updateColumnValue",innerValue:function(t,e){e?this.$emit("input",t):this.$emit("input",null)}},mounted:function(){var t=this;this.updateColumnValue(),this.$nextTick((function(){t.updateInnerValue()}))},methods:{getPicker:function(){return this.$refs.picker},onConfirm:function(){this.$emit("input",this.innerValue),this.$emit("confirm",this.innerValue)},onCancel:function(){this.$emit("cancel")}},render:function(){var t=this,e=arguments[0],n={};return Object.keys(g["b"]).forEach((function(e){n[e]=t[e]})),e(u["a"],{ref:"picker",attrs:{columns:this.columns,readonly:this.readonly},scopedSlots:this.$scopedSlots,on:{change:this.onChange,confirm:this.onConfirm,cancel:this.onCancel},props:Object(o["a"])({},n)})}},b=Object(c["a"])("time-picker"),x=b[0],I=x({mixins:[y],props:Object(o["a"])({},v,{minHour:{type:[Number,String],default:0},maxHour:{type:[Number,String],default:23},minMinute:{type:[Number,String],default:0},maxMinute:{type:[Number,String],default:59}}),computed:{ranges:function(){return[{type:"hour",range:[+this.minHour,+this.maxHour]},{type:"minute",range:[+this.minMinute,+this.maxMinute]}]}},watch:{filter:"updateInnerValue",minHour:function(){var t=this;this.$nextTick((function(){t.updateInnerValue()}))},maxHour:function(t){var e=this.innerValue.split(":"),n=e[0],i=e[1];n>=t?(this.innerValue=this.formatValue(t+":"+i),this.updateColumnValue()):this.updateInnerValue()},minMinute:"updateInnerValue",maxMinute:function(t){var e=this.innerValue.split(":"),n=e[0],i=e[1];i>=t?(this.innerValue=this.formatValue(n+":"+t),this.updateColumnValue()):this.updateInnerValue()},value:function(t){t=this.formatValue(t),t!==this.innerValue&&(this.innerValue=t,this.updateColumnValue())}},methods:{formatValue:function(t){t||(t=Object(l["b"])(this.minHour)+":"+Object(l["b"])(this.minMinute));var e=t.split(":"),n=e[0],i=e[1];return n=Object(l["b"])(Object(h["b"])(n,this.minHour,this.maxHour)),i=Object(l["b"])(Object(h["b"])(i,this.minMinute,this.maxMinute)),n+":"+i},updateInnerValue:function(){var t=this.getPicker().getIndexes(),e=t[0],n=t[1],i=this.originColumns,a=i[0],r=i[1],s=a.values[e]||a.values[0],u=r.values[n]||r.values[0];this.innerValue=this.formatValue(s+":"+u),this.updateColumnValue()},onChange:function(t){var e=this;this.updateInnerValue(),this.$nextTick((function(){e.$nextTick((function(){e.$emit("change",t)}))}))},updateColumnValue:function(){var t=this,e=this.formatter,n=this.innerValue.split(":"),i=[e("hour",n[0]),e("minute",n[1])];this.$nextTick((function(){t.getPicker().setValues(i)}))}}});function C(t){return"[object Date]"===Object.prototype.toString.call(t)&&!Object(d["a"])(t.getTime())}var k=(new Date).getFullYear(),w=Object(c["a"])("date-picker"),V=w[0],D=V({mixins:[y],props:Object(o["a"])({},v,{type:{type:String,default:"datetime"},minDate:{type:Date,default:function(){return new Date(k-10,0,1)},validator:C},maxDate:{type:Date,default:function(){return new Date(k+10,11,31)},validator:C}}),watch:{filter:"updateInnerValue",minDate:function(){var t=this;this.$nextTick((function(){t.updateInnerValue()}))},maxDate:function(t){this.innerValue.valueOf()>=t.valueOf()?this.innerValue=t:this.updateInnerValue()},value:function(t){t=this.formatValue(t),t&&t.valueOf()!==this.innerValue.valueOf()&&(this.innerValue=t)}},computed:{ranges:function(){var t=this.getBoundary("max",this.innerValue?this.innerValue:this.minDate),e=t.maxYear,n=t.maxDate,i=t.maxMonth,a=t.maxHour,r=t.maxMinute,s=this.getBoundary("min",this.innerValue?this.innerValue:this.minDate),u=s.minYear,o=s.minDate,c=s.minMonth,l=s.minHour,h=s.minMinute,d=[{type:"year",range:[u,e]},{type:"month",range:[c,i]},{type:"day",range:[o,n]},{type:"hour",range:[l,a]},{type:"minute",range:[h,r]}];switch(this.type){case"date":d=d.slice(0,3);break;case"year-month":d=d.slice(0,2);break;case"month-day":d=d.slice(1,3);break;case"datehour":d=d.slice(0,4);break}if(this.columnsOrder){var m=this.columnsOrder.concat(d.map((function(t){return t.type})));d.sort((function(t,e){return m.indexOf(t.type)-m.indexOf(e.type)}))}return d}},methods:{formatValue:function(t){return C(t)?(t=Math.max(t,this.minDate.getTime()),t=Math.min(t,this.maxDate.getTime()),new Date(t)):null},getBoundary:function(t,e){var n,i=this[t+"Date"],a=i.getFullYear(),r=1,s=1,u=0,o=0;return"max"===t&&(r=12,s=p(e.getFullYear(),e.getMonth()+1),u=23,o=59),e.getFullYear()===a&&(r=i.getMonth()+1,e.getMonth()+1===r&&(s=i.getDate(),e.getDate()===s&&(u=i.getHours(),e.getHours()===u&&(o=i.getMinutes())))),n={},n[t+"Year"]=a,n[t+"Month"]=r,n[t+"Date"]=s,n[t+"Hour"]=u,n[t+"Minute"]=o,n},updateInnerValue:function(){var t,e,n,i=this,a=this.type,r=this.getPicker().getIndexes(),s=function(t){var e=0;i.originColumns.forEach((function(n,i){t===n.type&&(e=i)}));var n=i.originColumns[e].values;return f(n[r[e]])};"month-day"===a?(t=(this.innerValue?this.innerValue:this.minDate).getFullYear(),e=s("month"),n=s("day")):(t=s("year"),e=s("month"),n="year-month"===a?1:s("day"));var u=p(t,e);n=n>u?u:n;var o=0,c=0;"datehour"===a&&(o=s("hour")),"datetime"===a&&(o=s("hour"),c=s("minute"));var l=new Date(t,e-1,n,o,c);this.innerValue=this.formatValue(l)},onChange:function(t){var e=this;this.updateInnerValue(),this.$nextTick((function(){e.$nextTick((function(){e.$emit("change",t)}))}))},updateColumnValue:function(){var t=this,e=this.innerValue?this.innerValue:this.minDate,n=this.formatter,i=this.originColumns.map((function(t){switch(t.type){case"year":return n("year",""+e.getFullYear());case"month":return n("month",Object(l["b"])(e.getMonth()+1));case"day":return n("day",Object(l["b"])(e.getDate()));case"hour":return n("hour",Object(l["b"])(e.getHours()));case"minute":return n("minute",Object(l["b"])(e.getMinutes()));default:return null}}));this.$nextTick((function(){t.getPicker().setValues(i)}))}}}),j=Object(c["a"])("datetime-picker"),O=j[0],N=j[1],$=O({props:Object(o["a"])({},I.props,D.props),methods:{getPicker:function(){return this.$refs.root.getPicker()}},render:function(){var t=arguments[0],e="time"===this.type?I:D;return t(e,{ref:"root",class:N(),scopedSlots:this.$scopedSlots,props:Object(o["a"])({},this.$props),on:Object(o["a"])({},this.$listeners)})}}),M=n("d399"),S=n("da71"),_=n("c97a"),P=n("7e8e"),K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.showKey,expression:"showKey"}],staticClass:"gender",on:{click:function(e){return e.stopPropagation(),t.close.apply(null,arguments)}}},[n("div",{staticClass:"foot",style:t.footStyle},[n("div",{staticClass:"content"},[n("div",{on:{click:function(e){return e.stopPropagation(),t.sex("男","Male")}}},[t._v("男")]),n("div",{on:{click:function(e){return e.stopPropagation(),t.sex("女","Female")}}},[t._v("女")]),n("div",{on:{click:function(e){return e.stopPropagation(),t.sex("保密","Confidentiality")}}},[t._v("保密")])]),n("div",{staticClass:"close",on:{click:function(e){return e.stopPropagation(),t.close.apply(null,arguments)}}},[t._v("取消")])])])},T=[],A={data:function(){return{footStyle:{},showKey:!1}},watch:{showKey:function(t){var e=this;t?(this.footStyle={transition:"0.3s",bottom:"-20rem"},setTimeout((function(){e.footStyle={transition:"0.3s",bottom:"0rem"}}),10)):this.footStyle={transition:"0s",bottom:"0rem"}}},methods:{close:function(){this.showKey=!1},sex:function(t,e){this.$emit("change",t,e),this.showKey=!1}}},F=A,H=(n("212e"),n("2877")),Y=Object(H["a"])(F,K,T,!1,null,"130103b1",null),U=Y.exports,B={components:{GenderSelect:U,Picker:u["a"],DatetimePicker:$},data:function(){return{birthday:new Date,mubuKey:!1,mubuKey1:!1,genderName:"",userInfo:{nickName:""},multiIndex:["","","无"],multiArray:[{values:[],defaultIndex:0},{values:[],defaultIndex:0},{values:["无"],defaultIndex:0}],genderKey:!1,ajax:!1,type:"",minDate:new Date(1900,0,1),maxDate:new Date}},created:function(){var t=this.$route.query;this.type=t.type,this.getUserInfo(),this.multiArray[0].values=Object(s["a"])(P["counties"].map((function(t){return t.Name}))),this.multiArray[1].values=Object(s["a"])(P["counties"][0].Child.map((function(t){return t.Name}))),this.multiArray[2].values=Object(s["a"])(P["counties"][0].Child[0].Child.map((function(t){return t.Name})))},computed:{imgSrc:function(){return function(t){return S["d"]+t}},endDate:function(){var t=new Date,e=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate();return console.log("".concat(t.getFullYear(),"-").concat(e,"-").concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)},address:function(){return this.userInfo.province&&this.userInfo.city?this.userInfo.province+this.userInfo.city+(this.userInfo.county||""):"请选择"}},methods:{confirmDate:function(t){var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1,a=e.getDate();i=i<10?"0"+i:i,a=a<10?"0"+a:a,this.userInfo.birthday="".concat(n,"-").concat(i,"-").concat(a),this.closeDate()},closeDate:function(){this.mubuKey1=!1},onCancel:function(){this.mubuKey=!1},confirm:function(t,e){this.multiIndex=t,this.name1="";var n=e[0],i=e[1],a=e[2];this.userInfo.provinceId=P["counties"][n].Id,this.userInfo.cityId=P["counties"][n].Child[i].Id,this.userInfo.countyId=P["counties"][n].Child[i].Child?P["counties"][n].Child[i].Child[a].Id:"",this.userInfo.province=P["counties"][n].Name,this.userInfo.city=P["counties"][n].Child[i].Name,this.userInfo.county=P["counties"][n].Child[i].Child?P["counties"][n].Child[i].Child[a].Name:"",this.onCancel()},changeSex:function(t,e){this.genderName=t,this.userInfo.gender=e},showGender:function(){this.$refs.gender.showKey=!0},showAddress:function(){this.mubuKey=!0},bindDateChange:function(t){console.log(t.detail.value),this.userInfo.birthday=t.detail.value},showDate:function(){this.mubuKey1=!0},getUserInfo:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post("/api/v1/UserProfile/GetUserInfo",{type:1},{custom:{url:"99",nonce:Object(_["a"])(),timestamp:Object(_["b"])()}});case 2:n=e.sent,n&&1===n.data.code&&(t.genderName=n.data.data.genderText,t.userInfo=n.data.data,i=new Date(n.data.data.birthday),t.userInfo.birthday="".concat(i.getFullYear(),"-").concat(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,"-").concat(i.getDate()<10?"0"+i.getDate():i.getDate()));case 4:case"end":return e.stop()}}),e)})))()},changePicker:function(t,e,n){var i=this;this.multiIndex[n]=e[n];var a=null;switch(n){case 0:this.multiArray.splice(1,1,{values:Object(s["a"])(P["counties"].find((function(t){return t.Name===i.multiIndex[0]})).Child.map((function(t){return t.Name}))),defaultIndex:0}),a=P["counties"].find((function(t){return t.Name===i.multiIndex[0]})).Child[0].Child,this.multiArray.splice(2,1,{values:a&&0!==a.length?Object(s["a"])(a.map((function(t){return t.Name}))):[],defaultIndex:0});break;case 1:a=P["counties"].find((function(t){return t.Name===i.multiIndex[0]})).Child.find((function(t){return t.Name===i.multiIndex[1]})).Child,this.multiArray.splice(2,1,{values:a&&0!==a.length?Object(s["a"])(a.map((function(t){return t.Name}))):[],defaultIndex:0});break}},bindMultiPickerColumnChange:function(t){switch(this.multiIndex[t.detail.column]=t.detail.value,t.detail.column){case 0:this.multiArray[1]=Object(s["a"])(P["counties"][this.multiIndex[0]].Child.map((function(t){return t.Name}))),this.multiIndex.splice(1,1,0),this.multiArray[2]=Object(s["a"])(P["counties"][this.multiIndex[0]].Child[this.multiIndex[1]].Child.map((function(t){return t.Name}))||[]),this.multiIndex.splice(2,1,0);break;case 1:this.multiArray[2]=Object(s["a"])(P["counties"][this.multiIndex[0]].Child[this.multiIndex[1]].Child.map((function(t){return t.Name}))||[]),this.multiIndex.splice(2,1,0);break}this.$forceUpdate()},save:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.ajax){e.next=2;break}return e.abrupt("return");case 2:if(t.userInfo.provinceId&&t.userInfo.cityId){e.next=5;break}return Object(M["a"])("请填写地区"),e.abrupt("return");case 5:return t.ajax=!0,M["a"].loading({duration:0,message:"信息保存中...",forbidClick:!0}),e.next=9,t.$http.post("/api/v1/UserProfile/UpdateProfile",{nickName:t.userInfo.nickName,gender:t.userInfo.gender,birthday:t.userInfo.birthday,county:"".concat(t.userInfo.provinceId,",").concat(t.userInfo.cityId,",").concat(t.userInfo.countyId)},{custom:{url:"99",nonce:Object(_["a"])(),timestamp:Object(_["b"])()}});case 9:n=e.sent,t.ajax=!1,n&&1===n.data.code&&(Object(M["a"])("个人信息修改成功"),setTimeout((function(){"login"===t.type?t.$router.push("/index"):t.$router.go(-1)}),1e3));case 12:case"end":return e.stop()}}),e)})))()}}},E=B,G=(n("05c3"),Object(H["a"])(E,i,a,!1,null,"bb198cda",null));e["default"]=G.exports},"8b2d":function(t,e,n){}}]);
//# sourceMappingURL=userDetails.b1f2e39c.js.map